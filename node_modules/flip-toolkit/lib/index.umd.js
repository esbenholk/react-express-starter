!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rematrix")):"function"==typeof define&&define.amd?define(["exports","rematrix"],e):e(t.FlipToolkit={},t.rematrix)}(this,function(t,e){var i=function(t){return"number"==typeof t},n=function(t){return"function"==typeof t},r=function(t){return"[object Object]"===Object.prototype.toString.call(t)},o=function(t){return Array.prototype.slice.apply(t)},a=function(t){var e=t.reduce(function(t,e){return t[e]=(t[e]||0)+1,t},{});return Object.keys(e).filter(function(t){return e[t]>1})};function s(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return e.forEach(function(e){if(e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}),t}var l,p=function(t,e,i){return t+(e-t)*i},c={isNumber:i,isFunction:n,isObject:r,toArray:o,getDuplicateValsAsStrings:a,assign:s,tweenProp:p},u={noWobble:{stiffness:200,damping:26},gentle:{stiffness:120,damping:14},veryGentle:{stiffness:130,damping:17},wobbly:{stiffness:180,damping:12},stiff:{stiffness:260,damping:26}},d=function(t){return r(t)?t:Object.keys(u).indexOf(t)>-1?u[t]:{}};"undefined"!=typeof window&&(l=window.requestAnimationFrame);var f=l=l||function(t){window.setTimeout(t,1e3/60)},h=Date.now(),g="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()-h};function m(t,e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}var v=function(){};v.prototype.run=function(){var t=this;f(function(){t.springSystem.loop(g())})};var y=function(){this.position=0,this.velocity=0},_=0,S=function(t){this._id="s"+_++,this._springSystem=t,this.listeners=[],this._startValue=0,this._currentState=new y,this._displacementFromRestThreshold=.001,this._endValue=0,this._overshootClampingEnabled=!1,this._previousState=new y,this._restSpeedThreshold=.001,this._tempState=new y,this._timeAccumulator=0,this._wasAtRest=!0,this._cachedSpringConfig={}};S.prototype.getId=function(){return this._id},S.prototype.destroy=function(){this.listeners=[],this._springSystem.deregisterSpring(this)},S.prototype.setSpringConfig=function(t){return this._springConfig=t,this},S.prototype.getCurrentValue=function(){return this._currentState.position},S.prototype.getDisplacementDistanceForState=function(t){return Math.abs(this._endValue-t.position)},S.prototype.setEndValue=function(t){if(t===this._endValue)return this;if(this.prevEndValue=t,this._endValue===t&&this.isAtRest())return this;this._startValue=this.getCurrentValue(),this._endValue=t,this._springSystem.activateSpring(this.getId());for(var e=0,i=this.listeners.length;e<i;e++){var n=this.listeners[e].onSpringEndStateChange;n&&n(this)}return this},S.prototype.setVelocity=function(t){return t===this._currentState.velocity?this:(this._currentState.velocity=t,this._springSystem.activateSpring(this.getId()),this)},S.prototype.setCurrentValue=function(t){this._startValue=t,this._currentState.position=t;for(var e=0,i=this.listeners.length;e<i;e++){var n=this.listeners[e];n.onSpringUpdate&&n.onSpringUpdate(this)}return this},S.prototype.setAtRest=function(){return this._endValue=this._currentState.position,this._tempState.position=this._currentState.position,this._currentState.velocity=0,this},S.prototype.setOvershootClampingEnabled=function(t){return this._overshootClampingEnabled=t,this},S.prototype.isOvershooting=function(){var t=this._startValue,e=this._endValue;return this._springConfig.tension>0&&(t<e&&this.getCurrentValue()>e||t>e&&this.getCurrentValue()<e)},S.prototype.advance=function(t,e){var i=this.isAtRest();if(!i||!this._wasAtRest){var n=e;e>.064&&(n=.064),this._timeAccumulator+=n;for(var r,o,a,s,l,p,c=this._springConfig.tension,u=this._springConfig.friction,d=this._currentState.position,f=this._currentState.velocity,h=this._tempState.position,g=this._tempState.velocity;this._timeAccumulator>=.001;)this._timeAccumulator-=.001,this._timeAccumulator<.001&&(this._previousState.position=d,this._previousState.velocity=f),o=c*(this._endValue-h)-u*f,s=c*(this._endValue-(h=d+.001*(r=f)*.5))-u*(g=f+.001*o*.5),p=c*(this._endValue-(h=d+.001*(a=g)*.5))-u*(g=f+.001*s*.5),h=d+.001*(l=g),d+=1/6*(r+2*(a+l)+(g=f+.001*p))*.001,f+=1/6*(o+2*(s+p)+(c*(this._endValue-h)-u*g))*.001;this._tempState.position=h,this._tempState.velocity=g,this._currentState.position=d,this._currentState.velocity=f,this._timeAccumulator>0&&this._interpolate(this._timeAccumulator/.001),(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting())&&(this._springConfig.tension>0?(this._startValue=this._endValue,this._currentState.position=this._endValue):(this._endValue=this._currentState.position,this._startValue=this._endValue),this.setVelocity(0),i=!0);var m=!1;this._wasAtRest&&(this._wasAtRest=!1,m=!0);var v=!1;i&&(this._wasAtRest=!0,v=!0),this.notifyPositionUpdated(m,v)}},S.prototype.notifyPositionUpdated=function(t,e){var i=this;this.listeners.filter(Boolean).forEach(function(n){t&&n.onSpringActivate&&!i._onActivateCalled&&(n.onSpringActivate(i),i._onActivateCalled=!0),n.onSpringUpdate&&n.onSpringUpdate(i),e&&n.onSpringAtRest&&n.onSpringAtRest(i)})},S.prototype.systemShouldAdvance=function(){return!this.isAtRest()||!this.wasAtRest()},S.prototype.wasAtRest=function(){return this._wasAtRest},S.prototype.isAtRest=function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&(this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold||0===this._springConfig.tension)},S.prototype._interpolate=function(t){this._currentState.position=this._currentState.position*t+this._previousState.position*(1-t),this._currentState.velocity=this._currentState.velocity*t+this._previousState.velocity*(1-t)},S.prototype.addListener=function(t){return this.listeners.push(t),this},S.prototype.addOneTimeListener=function(t){var e=this;return Object.keys(t).forEach(function(i){var n;t[i]=(n=t[i],function(){for(var i=[],r=arguments.length;r--;)i[r]=arguments[r];n.apply(void 0,i),e.removeListener(t)})}),this.listeners.push(t),this},S.prototype.removeListener=function(t){return m(this.listeners,t),this};var E=function(t){this.looper=t||new v,this.looper.springSystem=this,this.listeners=[],this._activeSprings=[],this._idleSpringIndices=[],this._isIdle=!0,this._lastTimeMillis=-1,this._springRegistry={}};E.prototype.createSpring=function(t,e){return this.createSpringWithConfig({tension:t,friction:e})},E.prototype.createSpringWithConfig=function(t){var e=new S(this);return this.registerSpring(e),e.setSpringConfig(t),e},E.prototype.getIsIdle=function(){return this._isIdle},E.prototype.registerSpring=function(t){this._springRegistry[t.getId()]=t},E.prototype.deregisterSpring=function(t){m(this._activeSprings,t),delete this._springRegistry[t.getId()]},E.prototype.advance=function(t,e){for(var i=this;this._idleSpringIndices.length>0;)this._idleSpringIndices.pop();for(this._activeSprings.filter(Boolean).forEach(function(n){n.systemShouldAdvance()?n.advance(t/1e3,e/1e3):i._idleSpringIndices.push(i._activeSprings.indexOf(n))});this._idleSpringIndices.length>0;){var n=this._idleSpringIndices.pop();n>=0&&this._activeSprings.splice(n,1)}},E.prototype.loop=function(t){var e;-1===this._lastTimeMillis&&(this._lastTimeMillis=t-1);var i=t-this._lastTimeMillis;this._lastTimeMillis=t;var n=0,r=this.listeners.length;for(n=0;n<r;n++)(e=this.listeners[n]).onBeforeIntegrate&&e.onBeforeIntegrate(this);for(this.advance(t,i),0===this._activeSprings.length&&(this._isIdle=!0,this._lastTimeMillis=-1),n=0;n<r;n++)(e=this.listeners[n]).onAfterIntegrate&&e.onAfterIntegrate(this);this._isIdle||this.looper.run()},E.prototype.activateSpring=function(t){var e=this._springRegistry[t];-1===this._activeSprings.indexOf(e)&&this._activeSprings.push(e),this.getIsIdle()&&(this._isIdle=!1,this.looper.run())};var A=new E,C=function(t){var e=t.springConfig,i=e.overshootClamping,n=t.getOnUpdateFunc,r=t.onAnimationEnd,o=t.onSpringActivate,a=A.createSpring(e.stiffness,e.damping);a.setOvershootClampingEnabled(!!i);var s={onSpringActivate:o,onSpringAtRest:function(){a.destroy(),r()},onSpringUpdate:n({spring:a,onAnimationEnd:r})};return a.addListener(s),a},b=function(t){var e=C(t);return e.setEndValue(1),e},I=function(t,e){if(void 0===e&&(e={}),t&&t.length){e.reverse&&t.reverse();var i,n="number"!=typeof(i=e.speed)?1.1:1+Math.min(Math.max(5*i,0),5),r=1/Math.max(Math.min(t.length,100),10),o=t.map(function(t,e){var i=t.getOnUpdateFunc;return t.getOnUpdateFunc=function(t){var a=i(t);return function(t){var i=t.getCurrentValue();(i=i<.01?0:i>.99?1:i)>=r&&o[e+1]&&o[e+1](Math.max(Math.min(i*n,1),0)),a(t)}},t}).map(function(t){var e=C(t);if(e)return e.setEndValue.bind(e)}).filter(Boolean);o[0]&&o[0](1)}},O=function(t){return[0,1,4,5,12,13].map(function(e){return t[e]})},w=function(t){return t.top<window.innerHeight&&t.bottom>0&&t.left<window.innerWidth&&t.right>0},x=function(t,e){var i;return s(t,((i={})[e[0]]=e[1],i))},U=function(t,e){return o(e?document.querySelectorAll('[data-portal-key="'+e+'"]'):t.querySelectorAll("[data-flip-id]"))},V=function(t){return t.map(function(t){return[t,t.getBoundingClientRect()]})},F=function(t){var r=t.cachedOrderedFlipIds;void 0===r&&(r=[]);var l=t.inProgressAnimations;void 0===l&&(l={});var c=t.flippedElementPositionsBeforeUpdate;void 0===c&&(c={});var f=t.flipCallbacks;void 0===f&&(f={});var h=t.containerEl,g=t.applyTransformOrigin,m=t.spring,v=t.debug,y=t.portalKey,_=t.staggerConfig;void 0===_&&(_={});var S=t.decisionData;void 0===S&&(S={});var E=t.handleEnterUpdateDelete,A=t.onComplete,C=t.onStart,F=function(t){return V(U(t.element,t.portalKey)).map(function(t){var e=t[0],i=t[1],n=window.getComputedStyle(e);return[e.dataset.flipId,{element:e,rect:i,opacity:parseFloat(n.opacity),transform:n.transform}]}).reduce(x,{})}({element:h,portalKey:y}),P=function(t){var e=t.containerEl,i=t.portalKey;return i?function(t){return function(e){return o(document.querySelectorAll('[data-portal-key="'+t+'"]'+e))}}(i):e?function(t){var e=Math.random().toFixed(5);return t.dataset.flipperId=e,function(i){return o(t.querySelectorAll('[data-flipper-id="'+e+'"] '+i))}}(e):function(){return[]}}({containerEl:h,portalKey:y}),T=function(t){return function(e){return t('[data-flip-id="'+e+'"]')[0]}}(P),D=function(t){return c[t]&&F[t]},R=Object.keys(c).concat(Object.keys(F)).filter(function(t){return!D(t)}),k={flipCallbacks:f,getElement:T,flippedElementPositionsBeforeUpdate:c,flippedElementPositionsAfterUpdate:F,inProgressAnimations:l,decisionData:S},M=function(t){var e,i=t.unflippedIds,n=t.flipCallbacks,r=t.getElement,o=t.flippedElementPositionsBeforeUpdate,a=t.flippedElementPositionsAfterUpdate,s=t.inProgressAnimations,l=t.decisionData,p=i.filter(function(t){return a[t]}).filter(function(t){return n[t]&&n[t].onAppear}),c=i.filter(function(t){return o[t]&&n[t]&&n[t].onExit}),u=new Promise(function(t){e=t}),d=[],f=0,h=c.map(function(t,i){var r=o[t].domDataForExitAnimations,a=r.element,p=r.parent,c=r.childPosition,u=c.top,h=c.left,g=c.width,m=c.height;"static"===getComputedStyle(p).position&&(p.style.position="relative"),a.style.transform="matrix(1, 0, 0, 1, 0, 0)",a.style.position="absolute",a.style.top=u+"px",a.style.left=h+"px",a.style.height=m+"px",a.style.width=g+"px";var v=d.filter(function(t){return t[0]===p})[0];v||(v=[p,document.createDocumentFragment()],d.push(v)),v[1].appendChild(a),f+=1;var y=function(){try{p.removeChild(a)}catch(t){}finally{0==(f-=1)&&e()}};return s[t]={stop:y},function(){return n[t].onExit(a,i,y,l)}});return d.forEach(function(t){t[0].appendChild(t[1])}),h.length||e(),{hideEnteringElements:function(){p.forEach(function(t){var e=r(t);e&&(e.style.opacity="0")})},animateEnteringElements:function(){p.forEach(function(t,e){var i=r(t);i&&n[t].onAppear(i,e,l)})},animateExitingElements:function(){return h.forEach(function(t){return t()}),u}}}(s({},k,{unflippedIds:R})),j=M.hideEnteringElements,B=M.animateEnteringElements,N=M.animateExitingElements,L=s({},k,{containerEl:h,flippedIds:r.filter(D),applyTransformOrigin:g,spring:m,debug:v,staggerConfig:_,scopedSelector:P,onComplete:A});C&&C(h,S);var q=function(t){var r=L.flippedIds,l=L.flipCallbacks,c=L.inProgressAnimations,f=L.flippedElementPositionsBeforeUpdate,h=L.flippedElementPositionsAfterUpdate,g=L.applyTransformOrigin,m=L.spring,v=L.getElement,y=L.debug,_=L.staggerConfig;void 0===_&&(_={});var S=L.decisionData;void 0===S&&(S={});var E,A=L.onComplete,C=L.containerEl,x=new Promise(function(t){E=t});if(A&&x.then(function(){return A(C,S)}),!r.length)return function(){return E([]),x};var U=[],V=v(r[0]),F=V?V.ownerDocument.querySelector("body"):document.querySelector("body");"production"!==process.env.NODE_ENV&&y&&console.error('[react-flip-toolkit]\nThe "debug" prop is set to true. All FLIP animations will return at the beginning of the transition.');var P=a(r);"production"!==process.env.NODE_ENV&&P.length&&console.error("[react-flip-toolkit]\nThere are currently multiple elements with the same flipId on the page.\nThe animation will only work if each Flipped component has a unique flipId.\nDuplicate flipId"+(P.length>1?"s":"")+": "+P.join("\n"));var T=r.map(function(t){var r=f[t].rect,a=h[t].rect,v=f[t].opacity,y=h[t].opacity,_=a.width<1||a.height<1,A=h[t].element;if(!w(r)&&!w(a))return!1;if(!A)return!1;var C=JSON.parse(A.dataset.flipConfig),b=function(t){void 0===t&&(t={});var e=t.flippedSpring;return s({},u.noWobble,d(t.flipperSpring),d(e))}({flipperSpring:m,flippedSpring:C.spring}),I=!0===C.stagger?"default":C.stagger,x={element:A,id:t,stagger:I,springConfig:b};if(l[t]&&l[t].shouldFlip&&!l[t].shouldFlip(S.previous,S.current))return!1;var V=Math.abs(r.left-a.left)+Math.abs(r.top-a.top),P=Math.abs(r.width-a.width)+Math.abs(r.height-a.height),D=Math.abs(y-v);if(V<.5&&P<.5&&D<.01)return!1;var R=e.parse(h[t].transform),k={matrix:R},M={matrix:[]},j=[R];C.translate&&(j.push(e.translateX(r.left-a.left)),j.push(e.translateY(r.top-a.top))),C.scale&&(j.push(e.scaleX(Math.max(r.width,1)/Math.max(a.width,1))),j.push(e.scaleY(Math.max(r.height,1)/Math.max(a.height,1)))),C.opacity&&(M.opacity=v,k.opacity=y);var B=[];if(!l[t]||!l[t].shouldInvert||l[t].shouldInvert(S.previous,S.current)){var N=function(t,e){return o(t.querySelectorAll('[data-inverse-flip-id="'+e+'"]'))}(A,t);B=N.map(function(t){return[t,JSON.parse(t.dataset.flipConfig)]})}M.matrix=O(j.reduce(e.multiply)),k.matrix=O(k.matrix);var L,q=function(t){var e=t.element,n=t.invertedChildren,r=t.body;return function(t){var o=t.matrix,a=t.opacity,s=t.forceMinVals;if(i(a)&&(e.style.opacity=a+""),s&&(e.style.minHeight="1px",e.style.minWidth="1px"),o){var l=function(t){return"matrix("+t.join(", ")+")"}(o);e.style.transform=l,n&&function(t){var e=t.matrix,i=t.body;t.invertedChildren.forEach(function(t){var n=t[0],r=t[1];if(i.contains(n)){var o=e[0],a=e[3],s=e[5],l={translateX:0,translateY:0,scaleX:1,scaleY:1},p="";r.translate&&(l.translateX=-e[4]/o,l.translateY=-s/a,p+="translate("+l.translateX+"px, "+l.translateY+"px)"),r.scale&&(l.scaleX=1/o,l.scaleY=1/a,p+=" scale("+l.scaleX+", "+l.scaleY+")"),n.style.transform=p}})}({invertedChildren:n,matrix:o,body:r})}}}({element:A,invertedChildren:B,body:F});if(l[t]&&l[t].onComplete){var X=l[t].onComplete;L=function(){return X(A,S)}}var Y=i(M.opacity)&&i(k.opacity)&&M.opacity!==k.opacity,K=!1;return s({},x,{stagger:I,springConfig:b,getOnUpdateFunc:function(e){var i=e.spring,n=e.onAnimationEnd;return c[t]={destroy:i.destroy.bind(i),onAnimationEnd:n},function(e){l[t]&&l[t].onSpringUpdate&&l[t].onSpringUpdate(e.getCurrentValue()),K||(K=!0,l[t]&&l[t].onStart&&l[t].onStart(A,S));var i=e.getCurrentValue();if(F.contains(A)){var n={matrix:[]};n.matrix=M.matrix.map(function(t,e){return p(t,k.matrix[e],i)}),Y&&(n.opacity=p(M.opacity,k.opacity,i)),q(n)}else e.destroy()}},initializeFlip:function(){q({matrix:M.matrix,opacity:Y?M.opacity:void 0,forceMinVals:_}),l[t]&&l[t].onStartImmediate&&l[t].onStartImmediate(A,S),C.transformOrigin?A.style.transformOrigin=C.transformOrigin:g&&(A.style.transformOrigin="0 0"),B.forEach(function(t){var e=t[0],i=t[1];i.transformOrigin?e.style.transformOrigin=i.transformOrigin:g&&(e.style.transformOrigin="0 0")})},onAnimationEnd:function(e){delete c[t],n(L)&&L(),A.style.transform="",B.forEach(function(t){t[0].style.transform=""}),_&&A&&(A.style.minHeight="",A.style.minWidth=""),e||(U.push(t),U.length>=T.length&&E(U))},delayUntil:C.delayUntil})}).filter(Boolean);if(T.forEach(function(t){return(0,t.initializeFlip)()}),y)return function(){};var D=T.filter(function(t){return t.delayUntil&&(e=t.delayUntil,T.filter(function(t){return t.id===e}).length);var e}),R={},k={},M={};D.forEach(function(t){t.stagger?(M[t.stagger]=!0,k[t.delayUntil]?k[t.delayUntil].push(t.stagger):k[t.delayUntil]=[t.stagger]):R[t.delayUntil]?R[t.delayUntil].push(t):R[t.delayUntil]=[t]});var j=T.filter(function(t){return t.stagger}).reduce(function(t,e){return t[e.stagger]?t[e.stagger].push(e):t[e.stagger]=[e],t},{}),B=T.filter(function(t){return-1===D.indexOf(t)});return B.forEach(function(t){t.onSpringActivate=function(){R[t.id]&&R[t.id].forEach(b),k[t.id]&&Object.keys(k[t.id].reduce(function(t,e){var i;return s(t,((i={})[e]=!0,i))},{})).forEach(function(t){I(j[t],_[t])})}}),function(){return T.length||E([]),B.filter(function(t){return!t.stagger}).forEach(b),Object.keys(j).forEach(function(t){M[t]||I(j[t],_[t])}),x}}();E?E({hideEnteringElements:j,animateEnteringElements:B,animateExitingElements:N,animateFlippedElements:q}):(j(),N().then(B),q())},P=function(t){var e=t.element,i=t.flipCallbacks;void 0===i&&(i={});var n=t.inProgressAnimations;void 0===n&&(n={});var r=U(e,t.portalKey),a=o(e.querySelectorAll("[data-inverse-flip-id]")),l={},p=[],c={};r.filter(function(t){return i&&i[t.dataset.flipId]&&i[t.dataset.flipId].onExit}).forEach(function(t){var e=t.parentNode;if(t.closest){var i=t.closest("[data-exit-container]");i&&(e=i)}var n=p.findIndex(function(t){return t[0]===e});-1===n&&(p.push([e,e.getBoundingClientRect()]),n=p.length-1),l[t.dataset.flipId]=p[n][1],c[t.dataset.flipId]=e});var u=V(r),d=u.map(function(t){var e=t[0],n=t[1],r={};if(i&&i[e.dataset.flipId]&&i[e.dataset.flipId].onExit){var o=l[e.dataset.flipId];s(r,{element:e,parent:c[e.dataset.flipId],childPosition:{top:n.top-o.top,left:n.left-o.left,width:n.width,height:n.height}})}return[e.dataset.flipId,{rect:n,opacity:parseFloat(window.getComputedStyle(e).opacity||"1"),domDataForExitAnimations:r}]}).reduce(x,{});return function(t,e){Object.keys(t).forEach(function(e){t[e].destroy&&t[e].destroy(),t[e].onAnimationEnd&&t[e].onAnimationEnd(!0),delete t[e]}),e.forEach(function(t){t.style.transform="",t.style.opacity=""})}(n,r.concat(a)),{flippedElementPositions:d,cachedOrderedFlipIds:u.map(function(t){return t[0].dataset.flipId})}},T=function(t){this.applyTransformOrigin=!0,s(this,t),this.inProgressAnimations={},this.flipCallbacks={},this.recordBeforeUpdate=this.recordBeforeUpdate.bind(this),this.update=this.update.bind(this),this.addFlipped=this.addFlipped.bind(this),this.addInverted=this.addInverted.bind(this)};T.prototype.recordBeforeUpdate=function(){this.snapshot=P({element:this.element,flipCallbacks:this.flipCallbacks,inProgressAnimations:this.inProgressAnimations})},T.prototype.update=function(t,e){this.snapshot&&(F({flippedElementPositionsBeforeUpdate:this.snapshot.flippedElementPositions,cachedOrderedFlipIds:this.snapshot.cachedOrderedFlipIds,containerEl:this.element,inProgressAnimations:this.inProgressAnimations,flipCallbacks:this.flipCallbacks,applyTransformOrigin:this.applyTransformOrigin,spring:this.spring,debug:this.debug,staggerConfig:this.staggerConfig,handleEnterUpdateDelete:this.handleEnterUpdateDelete,decisionData:{previous:t,current:e},onComplete:this.onComplete,onStart:this.onStart}),delete this.snapshot)},T.prototype.addFlipped=function(t){var e=t.element,i=t.flipId,n=t.opacity,r=t.translate,o=t.scale,a=t.transformOrigin,l=t.spring,p=t.stagger,c=t.delayUntil,u=t.onAppear,d=t.onStart,f=t.onSpringUpdate,h=t.onComplete,g=t.onExit,m=t.shouldFlip,v=t.shouldInvert;if(!e)throw new Error("no element provided");if(!i)throw new Error("No flipId provided");var y={scale:o,translate:r,opacity:n,transformOrigin:a,spring:l,stagger:p,delayUntil:c};y.scale||y.translate||y.opacity||s(y,{translate:!0,scale:!0,opacity:!0}),i&&(e.dataset.flipId=String(i)),e.dataset.flipConfig=JSON.stringify(y),this.flipCallbacks[i]={shouldFlip:m,shouldInvert:v,onAppear:u,onStart:d,onSpringUpdate:f,onComplete:h,onExit:g}},T.prototype.addInverted=function(t){var e=t.element,i=t.parent,n=t.opacity,r=t.translate,o=t.scale,a=t.transformOrigin;if(!e)throw new Error("no element provided");if(!i)throw new Error("parent must be provided");var l=i.dataset.flipId,p={scale:o,translate:r,opacity:n,transformOrigin:a};p.scale||p.translate||p.opacity||s(p,{translate:!0,scale:!0,opacity:!0}),e.dataset.inverseFlipId=l,e.dataset.flipConfig=JSON.stringify(p)};var D=new E;t.utilities=c,t.constants={DATA_FLIP_ID:"data-flip-id",DATA_INVERSE_FLIP_ID:"data-inverse-flip-id",DATA_FLIP_COMPONENT_ID:"data-flip-component-id",DATA_FLIP_CONFIG:"data-flip-config",DATA_PORTAL_KEY:"data-portal-key",DATA_EXIT_CONTAINER:"data-exit-container"},t.Flipper=T,t.getFlippedElementPositionsBeforeUpdate=P,t.onFlipKeyUpdate=F,t.spring=function(t){var e=t.values,i=t.onUpdate,n=t.delay;void 0===n&&(n=0);var r=t.onComplete,o=s({},u.noWobble,d(t.config)),a=o.overshootClamping,l=D.createSpring(o.stiffness,o.damping);return l.setOvershootClampingEnabled(!!a),l.addListener({onSpringAtRest:function(t){r&&r(),t.destroy()},onSpringUpdate:function(t){var n=t.getCurrentValue();if(!e)return i(n);var r=Object.keys(e).map(function(t){return[t,p(e[t][0],e[t][1],n)]}).reduce(function(t,e){var i;return Object.assign(t,((i={})[e[0]]=e[1],i))},{});i(r)}}),n?setTimeout(function(){l.setEndValue(1)},n):l.setEndValue(1),l}});
//# sourceMappingURL=index.umd.js.map
